<!DOCTYPE html>
{% extends "base_generic.html" %}
{% block content %}
<div>
	
     <div class="capt" id="capt" style="color:white;">Note: Click the <a href="" style="color:blue;">hyper-link</a> from <strong style="color:blue;">{{ counts }}</strong> names, subjects and scores for review!
     </div>	   
     <div id="status_bar_container" style="margin-left:-53px;width:100%;height:15px;position:relative;background:green;border:1px solid white;border-radius:1px;" hidden> 
          <input type="text" value="560 of 1000" disabled id="status_bar_animate" style="width:0%;height:14px;position:absolute;background:gray;text-align:center;font-size:70%;color:white;"> 
    </div>
  
        <table>
            <thead>
	       
            <tr><th>S/N</th><th>STUDENT NAMEs ({{ counts }})</th><th>Student ID</th><th>Class</th><th>Session</th></tr> 
              </thead>
          {% if all_page %}
          {% for scr in all_page %} 
          
          <tr>
            <td>{{ forloop.counter }}</td>
            <td style="cursor:pointer;" onclick="$('#hid_{{ forloop.counter }}').toggle()">{{ scr.full_name }}
            <div id="hid_{{ forloop.counter }}" hidden>
              <button style="line-height:65%;border:2px solid blue;color:black;border-radius:5px;"><a href="{% url 'pdf' ty=4 sx=scr.id pk=0 %}" title="{{ scr.student_id }}" style="color:red;">Report Card</a></button><button style="line-height:65%;border:2px solid blue;color:black;border-radius:5px;"><a href="{% url 'student_info' pk=scr.id %}" title="{{ scr.student_id }}" style="color:red;">Profile</a></button>
            </div>
            </td>
            <td>{{ scr.uid }}
            </td><td><button   style="line-height:65%;border:2px solid blue;color:black;border-radius:5px;" onclick="clet('{{ scr.Class }}')">{{ scr.Class }}</button></td><td>{{ scr.session }}</td>
          </tr> 
          
          {% endfor %}
          {% else %}
              <pre style="width:70%;" >There are no records.</pre>
          {% endif %}
          <tfoot>
                <tr><th colspan="5">
                     {% if all_page.has_other_pages %}
              <em class="pagination" >
                {% if all_page.has_previous %}
                  <li style="width:5%;line-height:65%;">
                    <a href="?page={{ users.previous_page_number }}" style="background-color:#CAA04F;border-radius:3px;border:1px solid orange;">&laquo;</a>
                  </li>
                {% else %}
                  <li class="disabled" style="width:5%;line-height:65%;">
                    <span style="background-color:#CAA04F;border-radius:3px;border:1px solid orange;">&laquo;</span>
                  </li>
                {% endif %}
                {% for i in all_page.paginator.page_range %}
                  {% if all_page.number == i %}
                    <li class="active" style="width:5%;line-height:65%;">
                      <span style="background-color:#CAA04F;border-radius:3px;border:1px solid orange;font-weight:bold;font-size:11px;line-height:65%;">{{ i }} <span class="sr-only">(current)</span></span>
                    </li>
                  {% else %}
                    <li style="width:5%;line-height:65%;">
                      <a href="?page={{ i }} "style="background-color:#CAA04F;border-radius:3px;border:1px solid orange;">{{ i }}</a>
                    </li>
                  {% endif %}
                {% endfor %}
                {% if all_page.has_next %}
                  <li style="width:5%;line-height:65%;">
                    <a href="?page={{ users.next_page_number }} "style="background-color:#CAA04F;border-radius:3px;border:1px solid orange;">&raquo;</a>
                  </li>
                {% else %}
                  <li class="disabled" style="width:5%;line-height:65%;">
                    <span style="background-color:#CAA04F;border-radius:3px;border:1px solid orange;">&raquo;</span>
                  </li>
                {% endif %}
              </em>
            {% endif %}
            
               <div style="color:white; font-size:13px;">Summary</div>|<button style="line-height:65%;border:2px solid blue;color:black;border-radius:5px;background-color:green;" title="Click to update JSS1 names" onclick="sycName('1')">{{Jo}}</button>--<button style="line-height:65%;border:2px solid blue;color:black;border-radius:5px;background-color:red;" title="Click to update JSS2 names" onclick="sycName(2)">{{Jt}}</button>--<button style="line-height:65%;border:2px solid blue;color:black;border-radius:5px;background-color:blue;" title="Click to update JSS3 names" onclick="sycName(3)">{{Jh}}</button>--<button style="line-height:65%;border:2px solid blue;color:black;border-radius:5px;background-color:green;" title="Click to update SSS1 names" onclick="sycName(4)" id='downloading'>{{So}}</button>--<button style="line-height:65%;border:2px solid blue;color:black;border-radius:5px;background-color:red;" title="Click to update SSS2 names" onclick="sycName(5)">{{St}}</button>--<button style="line-height:65%;border:2px solid blue;color:black;border-radius:5px;background-color:blue;" title="Click to update SSS3 names" onclick="sycName(6)">{{Sh}}</button>| <div style="color:white;font-size:13px;">{{ counts }} names returned </div></th></tr>
          
          </tfoot>
          
        </table>
        <script>
          var ErrorMap = {
              '0': "Not connected.\nPlease verify your network connection.",
              '400' : "Server understood the request, but request content was invalid.",
              '401' : "Unauthorized access.",
              '403' : "Forbidden resource can't be accessed.",
              '404': "The requested page not found.",
              '500' : "Internal server error.",
              '503' : "Service unavailable.",
              'parsererror' : "Requested JSON parse failed.",
              'timeout': "Time out error.",
              'abort': "Ajax request aborted.",
          };
          function clet(x){
                 var ind = x.split(' ')[1];
                 redirect('results_junior_senior/'+ind)
                  };
          var cls = {class:1};
          function sycName(cla){
            cls.class = cla;
            $('#status_bar_container').show();
            $('#capt').hide()
          var request  = $.ajax({
          url: "http://uqhs.herokuapp.com/result/synchronizing/3/1/"+cla+"/",
          data: {
                'subject':1
                },
          dataType: 'json',
          });
          request.done(function(data) { 
            if (window.location.href.split(':')[1] == '//127.0.0.1')
                {
                for (var i = 0; i < data.response.length;  i++){
                    var itr = ""+i;
                    var titles = ['full_name', 'uid', 'birth_date', 'age', 'Class', 'gender', 'term', 'no_open', 'no_present', 'no_absent', 'no_of_day_abs', 'purpose', 'remark', 'W_begin', 'W_end', 'H_begin', 'H_end', 'good', 'fair', 'poor', 'event', 'indoor', 'ball', 'combat', 'track', 'jump', 'throw', 'swim', 'lift', 'sport_comment', 'club_one', 'club_two', 'contrib_one', 'contrib_two', 'master_comment', 'principal_comment', 'resumption', 'serial_no'];
                    var jdata = {'sn':i, 'len':data.response.length};
                    for (var r = 0; r < data.response[i].length; r++){
                      jdata[titles[r]] = data.response[i][r];
                    };
                    var sub_request = $.ajax({
                    url:"http://127.0.0.1:8838/result/synchronizing/3/2/"+cls.class+"/",
                    data:jdata,
                    dataType: 'json',
                      });
                    sub_request.done(function(data) {
                      status(Number(data.sn), Number(data.len), 'main');
                      });
                    sub_request.fail(function(jqXHR, textStatus){
                      alert(ErrorMap[jqXHR.status])
                      $('#status_bar_container').hide()
                      $('#capt').show()
                      });
                      };
                      }});  
        request.fail(function(jqXHR, textStatus, data) {
                        alert(ErrorMap[jqXHR.status]);
                      $('#status_bar_container').hide()
                      $('#capt').show()
                        });
                      
          
	}   
        </script>

{% endblock %}


